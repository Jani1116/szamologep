<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Smart Toolbox 2026 Pro</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.8.0/math.js"></script>
    <script defer src="https://unpkg.com/mathlive"></script>
    <style>
        :root {
            --bg: #000; --card: #1c1c1e; --accent: #0a84ff; --text: #fff; 
            --gray: #8e8e93; --border: #38383a; --red: #ff453a; --success: #30d158;
        }
        body { font-family: -apple-system, sans-serif; background: var(--bg); color: var(--text); margin: 0; padding: 10px; overflow-x: hidden; }
        .container { max-width: 800px; margin: auto; background: var(--card); border-radius: 25px; padding: 20px; min-height: 94vh; display: flex; flex-direction: column; border: 1px solid var(--border); box-sizing: border-box; }
        .hidden { display: none !important; }
        
        h1, h2 { text-align: center; font-weight: 700; margin-bottom: 15px; }

        /* GOMBOK √âS INPUTOK */
        .btn-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; }
        .btn-3d { 
            background: #333; border: none; border-radius: 12px; color: white; font-size: 18px; font-weight: bold;
            padding: 15px 0; cursor: pointer; box-shadow: 0 4px #1a1a1a; transition: all 0.1s; position: relative;
        }
        .btn-3d:active { box-shadow: 0 1px #1a1a1a; transform: translateY(3px); }
        .btn-op { background: #444; color: var(--accent); }
        .btn-eq { background: var(--accent); color: white; box-shadow: 0 4px #0056b3; }
        .btn-danger { background: var(--red); box-shadow: 0 4px #a0201a; }

        .main-btn { background: #2c2c2e; color: white; border: none; padding: 18px; border-radius: 15px; margin: 6px 0; font-size: 16px; font-weight: 600; cursor: pointer; width: 100%; text-align: left; display: flex; justify-content: space-between; align-items: center; }
        
        input { background: #2c2c2e; border: 1px solid var(--border); color: white; padding: 12px; border-radius: 10px; width: 100%; font-size: 16px; box-sizing: border-box; margin-bottom: 10px; }
        
        /* SPECI√ÅLIS PANEL */
        .unit-row { display: grid; grid-template-columns: 1fr 100px; gap: 10px; margin-bottom: 8px; align-items: center; }
        .unit-label { font-size: 14px; color: var(--gray); margin-left: 5px; }
        
        #calc-display { text-align:right; font-size:32px; height:80px; background:transparent; border:none; margin-bottom: 10px; word-wrap: break-word; }
        .back-btn { background: #333; color: white; border: 1px solid var(--border); padding: 15px; border-radius: 16px; width: 100%; margin-top: auto; font-weight: 600; }
        .result-box { background: rgba(10, 132, 255, 0.1); padding: 15px; border-radius: 14px; border: 1px solid var(--accent); margin: 10px 0; font-weight: 700; text-align: center; min-height: 24px; }
    </style>
</head>
<body>

<div class="container" id="menu">
    <div style="font-size: 50px; text-align: center; margin: 10px 0;">üõ†Ô∏è</div>
    <h1>Smart Toolbox 2026</h1>
    <button class="main-btn" onclick="show('calc')">üî¢ Tudom√°nyos Sz√°mol√≥g√©p <span>‚Ä∫</span></button>
    <button class="main-btn" onclick="show('romai')">üèõÔ∏è R√≥mai-Arab Konverter <span>‚Ä∫</span></button>
    <button class="main-btn" onclick="show('hossz')">üìè Profi Hosszv√°lt√≥ <span>‚Ä∫</span></button>
    <button class="main-btn" onclick="show('egyenlet')">‚ûó Egyenletmegold√≥ & Rajz <span>‚Ä∫</span></button>
</div>

<div class="container hidden" id="calc">
    <div id="calc-display">0</div>
    <div class="btn-grid" style="grid-template-columns: repeat(5, 1fr);">
        <button class="btn-3d btn-danger" onclick="clearCalc()">AC</button>
        <button class="btn-3d btn-op" onclick="backspace()">‚å´</button>
        <button class="btn-3d btn-op" onclick="appendCalc('math.pi')">œÄ</button>
        <button class="btn-3d btn-op" onclick="appendCalc('^')">^</button>
        <button class="btn-3d btn-op" onclick="appendCalc('/')">√∑</button>
        
        <button class="btn-3d" onclick="appendCalc('7')">7</button>
        <button class="btn-3d" onclick="appendCalc('8')">8</button>
        <button class="btn-3d" onclick="appendCalc('9')">9</button>
        <button class="btn-3d btn-op" onclick="appendCalc('*')">√ó</button>
        <button class="btn-3d btn-op" onclick="customRoot()">‚Åø‚àö</button>

        <button class="btn-3d" onclick="appendCalc('4')">4</button>
        <button class="btn-3d" onclick="appendCalc('5')">5</button>
        <button class="btn-3d" onclick="appendCalc('6')">6</button>
        <button class="btn-3d btn-op" onclick="appendCalc('-')">-</button>
        <button class="btn-3d btn-op" onclick="appendCalc('(')">(</button>

        <button class="btn-3d" onclick="appendCalc('1')">1</button>
        <button class="btn-3d" onclick="appendCalc('2')">2</button>
        <button class="btn-3d" onclick="appendCalc('3')">3</button>
        <button class="btn-3d btn-op" onclick="appendCalc('+')">+</button>
        <button class="btn-3d btn-op" onclick="appendCalc(')')">)</button>

        <button class="btn-3d" style="grid-column: span 2;" onclick="appendCalc('0')">0</button>
        <button class="btn-3d" onclick="appendCalc('.')">.</button>
        <button class="btn-3d btn-eq" style="grid-column: span 2;" onclick="calculate()">=</button>
    </div>
    <button class="back-btn" onclick="show('menu')">Vissza</button>
</div>

<div class="container hidden" id="romai">
    <h2>R√≥mai Konverter</h2>
    <div style="margin-bottom: 20px;">
        <label class="unit-label">Arab sz√°m (0-3999):</label>
        <input type="number" id="arab-in" placeholder="Pl: 2026" oninput="fromArab(this.value)">
    </div>
    <hr style="border: 0.5px solid var(--border); margin: 20px 0;">
    <div id="romai-billentyuk">
        <label class="unit-label">R√≥mai sz√°m:</label>
        <input type="text" id="rom-in" readonly placeholder="V√°lassz bet≈±ket...">
        <div class="btn-grid" style="margin-top:10px;">
            <button class="btn-3d" onclick="addRom('M')">M</button>
            <button class="btn-3d" onclick="addRom('D')">D</button>
            <button class="btn-3d" onclick="addRom('C')">C</button>
            <button class="btn-3d btn-danger" onclick="clearRom()">AC</button>
            <button class="btn-3d" onclick="addRom('L')">L</button>
            <button class="btn-3d" onclick="addRom('X')">X</button>
            <button class="btn-3d" onclick="addRom('V')">V</button>
            <button class="btn-3d" onclick="addRom('I')">I</button>
        </div>
    </div>
    <div id="rom-res-box" class="result-box" style="margin-top:20px; font-size: 24px;">Eredm√©ny: -</div>
    <button class="back-btn" onclick="show('menu')">Vissza</button>
</div>

<div class="container hidden" id="hossz">
    <h2>Profi Hosszv√°lt√≥</h2>
    <div id="unit-container">
        <div class="unit-row"><input type="number" id="unit_km" oninput="syncUnits('km')"><span class="unit-label">Kilom√©ter (km)</span></div>
        <div class="unit-row"><input type="number" id="unit_m" oninput="syncUnits('m')"><span class="unit-label">M√©ter (m)</span></div>
        <div class="unit-row"><input type="number" id="unit_dm" oninput="syncUnits('dm')"><span class="unit-label">Decim√©ter (dm)</span></div>
        <div class="unit-row"><input type="number" id="unit_cm" oninput="syncUnits('cm')"><span class="unit-label">Centim√©ter (cm)</span></div>
        <div class="unit-row"><input type="number" id="unit_mm" oninput="syncUnits('mm')"><span class="unit-label">Millim√©ter (mm)</span></div>
        <hr style="border-color: var(--border)">
        <div class="unit-row"><input type="number" id="unit_mi" oninput="syncUnits('mi')"><span class="unit-label">M√©rf√∂ld (mi)</span></div>
        <div class="unit-row"><input type="number" id="unit_yd" oninput="syncUnits('yd')"><span class="unit-label">Yard (yd)</span></div>
        <div class="unit-row"><input type="number" id="unit_in" oninput="syncUnits('in')"><span class="unit-label">Inch (in)</span></div>
    </div>
    <button class="back-btn" onclick="show('menu')">Vissza</button>
</div>

<div class="container hidden" id="egyenlet">
    <h2>Egyenlet & S Pen</h2>
    <math-field id="mf" style="width:100%; background:#2c2c2e; color:white; border-radius:12px; padding:10px;">x^2=16</math-field>
    <button class="btn-3d btn-eq" style="width:100%; margin: 10px 0;" onclick="solvePro()">Megold√°s (x)</button>
    <div id="canvas-container" style="border: 1px solid var(--border); background:#000; border-radius:15px; overflow:hidden;">
        <canvas id="spenCanvas" style="width:100%; height:250px; touch-action:none;"></canvas>
    </div>
    <button class="btn-3d btn-op" style="width:100%; margin-top:5px; font-size:14px;" onclick="ctx.clearRect(0,0,canvas.width,canvas.height)">V√°szon t√∂rl√©se</button>
    <div class="result-box" id="eq-res">x = ?</div>
    <button class="back-btn" onclick="show('menu')">Vissza</button>
</div>

<script>
    function show(id) { 
        document.querySelectorAll('.container').forEach(c => c.classList.add('hidden')); 
        document.getElementById(id).classList.remove('hidden');
        if(id==='egyenlet') resizeCanvas();
    }

    // --- SZ√ÅMOL√ìG√âP LOGIKA ---
    let calcExpr = "";
    const display = document.getElementById('calc-display');

    function formatNum(n) {
        if(isNaN(n)) return n;
        let parts = n.toString().split(".");
        parts[0] = parts[0].replace(/\B(?=(\d{3})+(?!\d))/g, " ");
        return parts.join(".");
    }

    function appendCalc(v) { 
        calcExpr += v; 
        updateDisplay();
    }
    
    function backspace() {
        calcExpr = calcExpr.slice(0, -1);
        updateDisplay();
    }

    function clearCalc() { calcExpr = ""; display.innerText = "0"; }

    function updateDisplay() {
        let printExpr = calcExpr.replace(/math\.pi/g, 'œÄ').replace(/\*/g, '√ó').replace(/\//g, '√∑');
        display.innerText = printExpr || "0";
    }

    function customRoot() {
        let n = prompt("H√°nyadik gy√∂k? (2, 3, 4...)", "2");
        if(n) appendCalc(`^(1/${n})`);
    }

    function calculate() {
        try {
            let res = math.evaluate(calcExpr);
            display.innerText = formatNum(math.format(res, {precision: 10}));
            calcExpr = res.toString();
        } catch(e) { display.innerText = "Hiba!"; calcExpr = ""; }
    }

    // --- R√ìMAI SZ√ÅMOK LOGIKA ---
    const romMap = {M:1000,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1};
    
    function fromArab(val) {
        if(!val || val < 1 || val > 3999) { document.getElementById('rom-res-box').innerText = "1-3999 k√∂z√∂tt adj meg sz√°mot!"; return; }
        let num = parseInt(val);
        let res = "";
        for(let i in romMap) { while(num >= romMap[i]) { res += i; num -= romMap[i]; } }
        document.getElementById('rom-res-box').innerText = "R√≥mai: " + res;
        document.getElementById('rom-in').value = ""; // Arab be√≠r√°skor a r√≥mai mez≈ë √ºr√ºl
    }

    function addRom(char) {
        let input = document.getElementById('rom-in');
        input.value += char;
        validateRom(input.value);
    }

    function clearRom() { document.getElementById('rom-in').value = ""; document.getElementById('rom-res-box').innerText = "Eredm√©ny: -"; }

    function validateRom(str) {
        // Valid√°ci√≥s regex: Szigor√∫ standard r√≥mai form√°tum
        const regex = /^(M{0,3})(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})$/;
        if(!regex.test(str) || str === "") {
            document.getElementById('rom-res-box').innerText = "H I B A ! ! !";
            return;
        }
        // Kisz√°m√≠t√°s
        let res = 0;
        for(let i=0; i<str.length; i++) {
            let s1 = romMap[str[i]];
            let s2 = romMap[str[i+1]];
            if(s2 > s1) { res += (s2 - s1); i++; }
            else { res += s1; }
        }
        document.getElementById('rom-res-box').innerText = "Arab: " + formatNum(res);
    }

    // --- HOSSZV√ÅLT√ì LOGIKA (Minden szinkronban) ---
    const factors = {
        km: 1000, m: 1, dm: 0.1, cm: 0.01, mm: 0.001,
        mi: 1609.344, yd: 0.9144, in: 0.0254
    };

    function syncUnits(sourceId) {
        let val = parseFloat(document.getElementById('unit_'+sourceId).value);
        if(isNaN(val)) return;
        let meters = val * factors[sourceId];
        
        for(let unit in factors) {
            if(unit !== sourceId) {
                document.getElementById('unit_'+unit).value = (meters / factors[unit]).toFixed(4);
            }
        }
    }

    // --- RAJZ & EGYENLET ---
    const canvas = document.getElementById('spenCanvas');
    const ctx = canvas.getContext('2d');
    let drawing = false;

    function resizeCanvas() {
        canvas.width = canvas.offsetWidth;
        canvas.height = 250;
        ctx.strokeStyle = "#0a84ff";
        ctx.lineCap = "round";
        ctx.lineJoin = "round";
    }

    canvas.addEventListener('pointerdown', (e) => { drawing = true; ctx.beginPath(); ctx.moveTo(e.offsetX, e.offsetY); });
    canvas.addEventListener('pointermove', (e) => {
        if(!drawing) return;
        ctx.lineWidth = (e.pressure > 0) ? e.pressure * 10 : 3; // S Pen nyom√°s√©rz√©kel√©s
        ctx.lineTo(e.offsetX, e.offsetY);
        ctx.stroke();
    });
    canvas.addEventListener('pointerup', () => drawing = false);

    function solvePro() {
        try {
            const mf = document.getElementById('mf');
            let eq = mf.getValue("ascii-math").split('=');
            let target = `(${eq[0]}) - (${eq[1]})`;
            let solution = math.numeric(math.evaluate(`solve(${target} = 0, x)`)); // Egyszer≈±s√≠tett h√≠v√°s
            document.getElementById('eq-res').innerText = "x = " + solution;
        } catch(e) { 
            // Newton-Raphson fallback ha a math.solve nem el√©rhet≈ë
            document.getElementById('eq-res').innerText = "Pr√≥b√°ld egyszer≈±bb form√°ban!";
        }
    }
</script>
</body>
</html>
